<!--
=========================================================
 Light Bootstrap Dashboard - v2.0.1
=========================================================

 Product Page: https://www.creative-tim.com/product/light-bootstrap-dashboard
 Copyright 2019 Creative Tim (https://www.creative-tim.com)
 Licensed under MIT (https://github.com/creativetimofficial/light-bootstrap-dashboard/blob/master/LICENSE)

 Coded by Creative Tim

=========================================================

 The above copyright notice and this permission notice shall be included in all copies or substantial portions of the Software.  -->
 <!DOCTYPE html>
 <html lang="en">
 
 <head>
     <meta charset="utf-8" />
     <link rel="apple-touch-icon" sizes="76x76"     href="{{ url_for('static', filename='assets/img/car.png' ) }}">
     <link rel="icon" type="image/png" href="{{ url_for('static', filename='assets/img/car.ico')}}">
     <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
     <title>Assurini</title>
     <meta content='width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0, shrink-to-fit=no' name='viewport' />
     <!--     Fonts and icons     -->
     <link href="https://fonts.googleapis.com/css?family=Montserrat:400,700,200" rel="stylesheet" />
     <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/latest/css/font-awesome.min.css" />
     <!-- CSS Files -->
     <link href="{{ url_for('static', filename='assets/css/bootstrap.min.css' ) }}
     " rel="stylesheet" />
     <link href="{{ url_for('static', filename='assets/css/light-bootstrap-dashboard.css')}}" rel="stylesheet" />
     <!-- CSS Just for demo purpose, don't include it in your project -->
     <link href="{{ url_for('static', filename='assets/css/demo.css')}}" rel="stylesheet" />
     <script>
        function printDiv() {
            var divContents = document.getElementById("content").innerHTML;
            var a = window.open('', '', 'height=500, width=500');
            a.document.write('<html>');
            a.document.write('<body >');
            a.document.write(divContents);
            a.document.write('</body></html>');
            a.document.close();
            a.print();
        }
    </script>
 </head>
 
 <body>
     <div class="wrapper">
        <div class="sidebar" data-image="{{ url_for('static', filename='assets/img/sidebar-5.jpg')}}" data-color="blue">
            <!--
         Tip 1: You can change the color of the sidebar using: data-color="purple | blue | green | orange | red"
 
         Tip 2: you can also add an image using data-image tag
     -->
             <div class="sidebar-wrapper" >
                 <div class="logo">
                    <img src="{{ url_for('static', filename='assuriniLogo.png')}}" style="width:200px;height:110px">

                     <a href="http://www.creative-tim.com" class="simple-text">
           </a>
                 </div>
                 <ul class="nav">
                     <li>
                        <a class="nav-link"href="{{ url_for('dash') }}">
                            <i class="nc-icon nc-chart-pie-35"></i>
                             <p>Dashboard</p>
                         </a>
                     </li>
                     <li class="nav-item active">
                        <a class="nav-link"href="{{ url_for('extractCIN') }}">
                            <i class="nc-icon nc-paper-2"></i>
                            <p>Insurance Contract</p>
                        </a>
                    </li>
                     <li >
                         <a class="nav-link" href="{{ url_for('home') }}">
                            <i class="nc-icon nc-bus-front-12"></i>
                            <p>Car Price Prediction</p>
                         </a>
                     </li>
                     <li>
                         <a class="nav-link" href="{{ url_for('hometypeassu') }}">
                             <i class="nc-icon nc-bullet-list-67"></i>
                             <p>Insurance Type</p>
                         </a>
                     </li>
                     <li>
                         <a class="nav-link"href="{{ url_for('homeassu') }}">
                             <i class="nc-icon nc-paper-2"></i>
                             <p>Insurance Price Pred</p>
                         </a>
                     </li>
                    
                    
                     
                    
                     <li class="nav-item active active-pro">
                         <a class="nav-link active" href="upgrade.html">
                             <i class="nc-icon nc-alien-33"></i>
                             <p>Upgrade to PRO</p>
                         </a>
                     </li>
                 </ul>
             </div>
         </div>
         <div class="main-panel">
             <!-- Navbar -->
             <nav class="navbar navbar-expand-lg " color-on-scroll="500">
                 <div class="container-fluid">
                     <a class="navbar-brand" href="{{ url_for('logout') }}"> {{ username }}  </a>
                     <button href="" class="navbar-toggler navbar-toggler-right" type="button" data-toggle="collapse" aria-controls="navigation-index" aria-expanded="false" aria-label="Toggle navigation">
                         <span class="navbar-toggler-bar burger-lines"></span>
                         <span class="navbar-toggler-bar burger-lines"></span>
                         <span class="navbar-toggler-bar burger-lines"></span>
                     </button>
                     <div class="collapse navbar-collapse justify-content-end" id="navigation">
                         <ul class="nav navbar-nav mr-auto">
                             <li class="nav-item">
                                
                             </li>
                           
                             <li class="nav-item">
                                
                             </li>
                         </ul>
                         <ul class="navbar-nav ml-auto">
                           
                           
                             <li class="nav-item">
                                 <a class="nav-link" href="{{ url_for('logout') }}">
                                     <span class="no-icon">Log out</span>
                                 </a>
                             </li>
                         </ul>
                     </div>
                 </div>
             </nav>
             <!-- End Navbar -->
             <div class="content">
                <div class="container-fluid">
                    <div class="row">
                        <div class="col-md-8">
                            <div class="card">
                                <div class="card-header">
                                    <h4 class="card-title">Contract Filling</h4>
                                </div>
                                <div class="card-body">
                                    <!DOCTYPE HTML>
                                    <html>
                                    <head>
                                        <meta charset="utf-8" />
                                        <title>Contract Filling</title>
                                        <meta name="viewport" content="width=device-width, initial-scale=1" />
                                        <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css" integrity="sha384-Gn5384xqQ1aoWXA+058RXPxPg6fy4IWvTNh0E263XmFcJlSAwiGgFAW/dAiS6JXm" crossorigin="anonymous">
                                    
                                        <script type="text/javascript" src="https://unpkg.com/xlsx@0.15.1/dist/xlsx.full.min.js"></script>
                                    </head>
                                    <body>
                                        <div class="container">
                                            <div class="card">
                                                <div class="card-header"><b>Select Excel File</b></div>
                                                <div class="card-body">
                                    
                                                    <input type="file" id="excel_file" />
                                    
                                                </div>
                                            </div>
                                            <div id="excel_data" class="mt-5"></div>
                                        </div>
                                       
                                        <a href="{{ url_for('printpdf') }}">
                                            <input type="button" value="View Contract" class="btn btn-info btn-fill pull-right" />
                                        </a>                                    
                                    </body>
                                    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/1.3.3/jspdf.min.js"></script>
                                    </html>
                                    
                                    <script>
                                    
                                        const excel_file = document.getElementById('excel_file');
                                    
                                        excel_file.addEventListener('change', (event) => {
                                    
                                            if (!['application/vnd.openxmlformats-officedocument.spreadsheetml.sheet', 'application/vnd.ms-excel'].includes(event.target.files[0].type)) {
                                                document.getElementById('excel_data').innerHTML = '<div class="alert alert-danger">Only .xlsx or .xls file format are allowed</div>';
                                    
                                                excel_file.value = '';
                                    
                                                return false;
                                            }
                                    
                                            var reader = new FileReader();
                                    
                                            reader.readAsArrayBuffer(event.target.files[0]);
                                    
                                            reader.onload = function (event) {
                                    
                                                var data = new Uint8Array(reader.result);
                                                console.log('reader result      '+reader.result)
                                                console.log('data    ' +data)
                                                var work_book = XLSX.read(data, { type: 'array' });
                                                console.log('work book     ' + work_book)
                                                var sheet_name = work_book.SheetNames;
                                                console.log('sheet name    ' + sheet_name)
                                                var sheet_data = XLSX.utils.sheet_to_json(work_book.Sheets[sheet_name[0]], { header: 1 });
                                                if (sheet_data.length > 0) {
                                                    var table_output = '<table class="table table-striped table-bordered">';
                                                    table_output += '<form id="form">'
                                                        for (var cell = 1; cell < sheet_data[0].length; cell++) {
                                                           
                                                                table_output += '<div class="form-group">';
                                                                table_output += sheet_data[0][cell]+'</label >';
                                                                table_output += '<input type="text" step="0.01" class="form-control" name="text" id="text" value="' + sheet_data[1][cell] + '" required>';
                                                                table_output += '</div>';
                                     
                                                    }
                                                    table_output += ' <div class="row">  '
                                                        table_output += ' <div class="col-md-12"> '
                                                            table_output += '    <div class="form-group"> '
                                                                table_output += '    <label for="fuel">Insurance Type:</label>'
                                                                table_output += '  <select class="form-control" >    <option value="routiere+options">routiere+options</option> <option value="dommage et collision">dommage et collision</option><option value="tout risque">tout risque</option>   </select><br>'
                                                                table_output += ' <div class="form-group"><label >Insurance Price </label><input type="number" step="0.01" class="form-control" placeholder="Price" required><br>   </div>'
                                                        
                                        
                                                  
                                                                table_output += ' </div> '
                                                    table_output += '</form>'
                                                    table_output += '</table>';
                                                    //table_output += '<button id="button">Generate PDF</button>'
                                    
                                                    document.getElementById('excel_data').innerHTML = table_output;
                                                }
                                    
                                                excel_file.value = '';
                                    
                                            }
                                    
                                        });
                                
                                       
                                    
                                    </script>
                                    
                                    <div >

                                            
                                        <!--</form>-->
                                        
                                    </div>
                                    <div>
                                        <img id="image" src="" />
                                    </div>
                                
                                    <!--<button type="button"
                                            onclick="show()" id="btnID">
                                        Show Image
                                    </button>-->
                                
                                    <script>
                                        function show() {
                                
                                            let image = document.getElementById("image");
                                            name = showname();
                                            image.src =
                                                "{{url_for('static', filename='uploads/CIN4.jpg')}}"
                                
                                            document.getElementById("btnID")
                                                .style.display = "none";
                                        }
                                        function showname() {
                                            var name = document.getElementById('file');
                                            //alert('Selected file: ' + name.files.item(0).name);
                                            return name.files.item(0).name;
                                        };
                                    </script>


            </div>
        </div>
    </div>
  
</div>
</div>



















            
                
            
            
               
            
            
           















             
             <footer class="footer">
                <div class="container-fluid">
                    <nav>
                       
                        <p class="copyright text-center">
                            ©
                            <script>
                                document.write(new Date().getFullYear())
                            </script>
                            <a href="http://www.creative-tim.com">Assurini</a>, Insure diffrently
                        </p>
                    </nav>
                </div>
            </footer>
         </div>
     </div>
     <!--   -->
     <!-- <div class="fixed-plugin">
     <div class="dropdown show-dropdown">
         <a href="#" data-toggle="dropdown">
             <i class="fa fa-cog fa-2x"> </i>
         </a>
 
         <ul class="dropdown-menu">
             <li class="header-title"> Sidebar Style</li>
             <li class="adjustments-line">
                 <a href="javascript:void(0)" class="switch-trigger">
                     <p>Background Image</p>
                     <label class="switch">
                         <input type="checkbox" data-toggle="switch" checked="" data-on-color="primary" data-off-color="primary"><span class="toggle"></span>
                     </label>
                     <div class="clearfix"></div>
                 </a>
             </li>
             <li class="adjustments-line">
                 <a href="javascript:void(0)" class="switch-trigger background-color">
                     <p>Filters</p>
                     <div class="pull-right">
                         <span class="badge filter badge-black" data-color="black"></span>
                         <span class="badge filter badge-azure" data-color="azure"></span>
                         <span class="badge filter badge-green" data-color="green"></span>
                         <span class="badge filter badge-orange" data-color="orange"></span>
                         <span class="badge filter badge-red" data-color="red"></span>
                         <span class="badge filter badge-purple active" data-color="purple"></span>
                     </div>
                     <div class="clearfix"></div>
                 </a>
             </li>
             <li class="header-title">Sidebar Images</li>
 
             <li class="active">
                 <a class="img-holder switch-trigger" href="javascript:void(0)">
                     <img src="{{ url_for('static', filename='assets/img/sidebar-1.jpg')}}" alt="" />
                 </a>
             </li>
             <li>
                 <a class="img-holder switch-trigger" href="javascript:void(0)">
                     <img href="{{ url_for('static', filename='assets/img/sidebar-3.jpg')}}" alt="" />
                 </a>
             </li>
             <li>
                 <a class="img-holder switch-trigger" href="javascript:void(0)">
                     <img src="{{ url_for('static', filename='/assets/img/sidebar-4.jpg')}}" alt="" />
                 </a>
             </li>
             <li>
                 <a class="img-holder switch-trigger" href="javascript:void(0)">
                     <img src="{{ url_for('static', filename='assets/img/sidebar-5.jpg')}}" alt="" />
                 </a>
             </li>
 
             <li class="button-container">
                 <div class="">
                     <a href="http://www.creative-tim.com/product/light-bootstrap-dashboard" target="_blank" class="btn btn-info btn-block btn-fill">Download, it's free!</a>
                 </div>
             </li>
 
             <li class="header-title pro-title text-center">Want more components?</li>
 
             <li class="button-container">
                 <div class="">
                     <a href="http://www.creative-tim.com/product/light-bootstrap-dashboard-pro" target="_blank" class="btn btn-warning btn-block btn-fill">Get The PRO Version!</a>
                 </div>
             </li>
 
             <li class="header-title" id="sharrreTitle">Thank you for sharing!</li>
 
             <li class="button-container">
                 <button id="twitter" class="btn btn-social btn-outline btn-twitter btn-round sharrre"><i class="fa fa-twitter"></i> · 256</button>
                 <button id="facebook" class="btn btn-social btn-outline btn-facebook btn-round sharrre"><i class="fa fa-facebook-square"></i> · 426</button>
             </li>
         </ul>
     </div>
 </div>
  -->
 </body>
 <!--   Core JS Files   -->
 <script src="{{ url_for('static', filename='assets/js/core/jquery.3.2.1.min.js')}}" type="text/javascript"></script>
 <script src="{{ url_for('static', filename='assets/js/core/popper.min.js')}}" type="text/javascript"></script>
 <script src="{{ url_for('static', filename='assets/js/core/bootstrap.min.js')}}" type="text/javascript"></script>
 <!--  Plugin for Switches, full documentation here: http://www.jque.re/plugins/version3/bootstrap.switch/ -->
 <script src="{{ url_for('static', filename='assets/js/plugins/bootstrap-switch.js')}}"></script>
 <!--  Google Maps Plugin    -->
 <script type="text/javascript" src="https://maps.googleapis.com/maps/api/js?key=YOUR_KEY_HERE"></script>
 <!--  Chartist Plugin  -->
 <script src="{{ url_for('static', filename='assets/js/plugins/chartist.min.js')}}"></script>
 <!--  Notifications Plugin    -->
 <script src="{{ url_for('static', filename='assets/js/plugins/bootstrap-notify.js')}}"></script>
 <!-- Control Center for Light Bootstrap Dashboard: scripts for the example pages etc -->
 <script src="{{ url_for('static', filename='assets/js/light-bootstrap-dashboard.js')}}" type="text/javascript"></script>
 <!-- Light Bootstrap Dashboard DEMO methods, don't include it in your project! -->
 <script src="{{ url_for('static', filename='assets/js/demo.js')}}"></script>
 </html>
 