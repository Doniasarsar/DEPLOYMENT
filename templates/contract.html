<!DOCTYPE html>
 <html lang="en">
     <head>
    <meta charset="utf-8" />
    <link rel="apple-touch-icon" sizes="76x76"     href="{{ url_for('static', filename='assets/img/car.png' ) }}">
    <link rel="icon" type="image/png" href="{{ url_for('static', filename='assets/img/car.ico')}}">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <title>Assurini</title>
    <meta content='width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0, shrink-to-fit=no' name='viewport' />
    <!--     Fonts and icons     -->
    <link href="https://fonts.googleapis.com/css?family=Montserrat:400,700,200" rel="stylesheet" />
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/latest/css/font-awesome.min.css" />
    <!-- CSS Files -->
    <link href="{{ url_for('static', filename='assets/css/bootstrap.min.css' ) }}
    " rel="stylesheet" />
    <link href="{{ url_for('static', filename='assets/css/light-bootstrap-dashboard.css')}}" rel="stylesheet" />
    <!-- CSS Just for demo purpose, don't include it in your project -->
    <link href="{{ url_for('static', filename='assets/css/demo.css')}}" rel="stylesheet" />
    <script>
       function printDiv() {
           var divContents = document.getElementById("content").innerHTML;
           var a = window.open('', '', 'height=500, width=500');
           a.document.write('<html>');
           a.document.write('<body >');
           a.document.write(divContents);
           a.document.write('</body></html>');
           a.document.close();
           a.print();
       }
   </script>
</head>
<div id="content" >
    <link rel="stylesheet" href="{{url_for('static', filename='css/style1.css')}}" media="all" />
    <style>
        
    </style>
    <header class="clearfix">
        <div id="logo">
            <img src="{{url_for('static', filename='logo.png')}}">
        </div>
        <div id="company">
            <h2 class="name">Assurini Company</h2>
            <div>20, technopole el Ghazela, Tunisia</div>
            <div>Tel : +216 54 896 654</div>
            <div>Fax : +216 71 896 654</div>
            <div><a href="mailto:company@example.com">contact@assurini.tn</a></div>
        </div>
    </header>
    <main>
        <div id="details" class="clearfix">
            <div id="client">
                <div class="to">Contract TO: 123456789 </div>
                <h2 class="name">Name : عزيز بن براهيم</h2>
                <div class="address">Year of birth: 2000</div>
            </div>
            <div id="invoice">
                <h1>INVOICE 5264580</h1>
                <div class="date">Date of Contract: 06/05/2022</div>
            </div>
        </div>
        <table border ="0" cellspacing="0" cellpadding="0">
            <thead>
                <tr>
                    <th class="no">#</th>
                    <th class="desc">CAR Characteristic</th>
                    <th class="unit">Description</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td class="no">01</td>
                    <td class="desc"><h3>Body</h3></td>
                    <td class="unit">ذات أربع أبواب</td>
                </tr>
                <tr>
                    <td class="no">02</td>
                    <td class="desc"><h3>Fiscal Power</h3></td>
                    <td class="unit">5</td>
                </tr>
                <tr>
                    <td class="no">03</td>
                    <td class="desc"><h3>Registration</h3></td>
                    <td class="unit">163 TU 6002</td>
                </tr>
                <tr>
                    <td class="no">03</td>
                    <td class="desc"><h3>Constructor</h3></td>
                    <td class="unit">VOLKSWAGEN</td>
                </tr>
                <tr>
                    <td class="no">03</td>
                    <td class="desc"><h3>Release</h3></td>
                    <td class="unit">15/07/2021</td>
                </tr>
                <tr>
                    <td class="no">03</td>
                    <td class="desc"><h3>Type of constructor</h3></td>
                    <td class="unit">GOLF 6</td>
                </tr>

            </tbody>
            <tfoot>
                <tr>
                    <td colspan="2"></td>
                    <td colspan="2">TOTAL HT</td>
                    <td>3,000 DT</td>
                </tr>
                <tr>
                    <td colspan="2"></td>
                    <td colspan="2">TAX 25%</td>
                    <td>750 DT</td>
                </tr>
                <tr>
                    <td colspan="2"></td>
                    <td colspan="2">GRAND TOTAL</td>
                    <td>3,750 DT</td>
                </tr>
            </tfoot>
        </table>
        <div id="notices">
            <div>NOTICE:</div>
            <div class="notice">If you have any problem, you can contact us any time</div>
        </div>
    </main>
    <footer>
        Assurini Company -  Created by MACN'Y team
    </footer>
</div>
<input type="button" value="Print" onclick="printDiv()" class="btn btn-info btn-fill pull-right">
<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/1.3.3/jspdf.min.js"></script>
                                    </html>
                                    
                                    <script>
                                    
                                        const excel_file = document.getElementById('excel_file');
                                    
                                        excel_file.addEventListener('change', (event) => {
                                    
                                            if (!['application/vnd.openxmlformats-officedocument.spreadsheetml.sheet', 'application/vnd.ms-excel'].includes(event.target.files[0].type)) {
                                                document.getElementById('excel_data').innerHTML = '<div class="alert alert-danger">Only .xlsx or .xls file format are allowed</div>';
                                    
                                                excel_file.value = '';
                                    
                                                return false;
                                            }
                                    
                                            var reader = new FileReader();
                                    
                                            reader.readAsArrayBuffer(event.target.files[0]);
                                    
                                            reader.onload = function (event) {
                                    
                                                var data = new Uint8Array(reader.result);
                                                console.log('reader result      '+reader.result)
                                                console.log('data    ' +data)
                                                var work_book = XLSX.read(data, { type: 'array' });
                                                console.log('work book     ' + work_book)
                                                var sheet_name = work_book.SheetNames;
                                                console.log('sheet name    ' + sheet_name)
                                                var sheet_data = XLSX.utils.sheet_to_json(work_book.Sheets[sheet_name[0]], { header: 1 });
                                                if (sheet_data.length > 0) {
                                                    var table_output = '<table class="table table-striped table-bordered">';
                                                    table_output += '<form id="form">'
                                                        for (var cell = 1; cell < sheet_data[0].length; cell++) {
                                                           
                                                                table_output += '<div class="form-group">';
                                                                table_output += sheet_data[0][cell]+'</label >';
                                                                table_output += '<input type="text" step="0.01" class="form-control" name="text" id="text" value="' + sheet_data[1][cell] + '" required>';
                                                                table_output += '</div>';
                                     
                                                    }
                                                    table_output += ' <div class="row">  '
                                                        table_output += ' <div class="col-md-12"> '
                                                            table_output += '    <div class="form-group"> '
                                                                table_output += '    <label for="fuel">Insurance Type:</label>'
                                                                table_output += '  <select class="form-control" >    <option value="routiere+options">routiere+options</option> <option value="dommage et collision">dommage et collision</option><option value="tout risque">tout risque</option>   </select><br>'
                                                                table_output += ' <div class="form-group"><label >Insurance Price </label><input type="number" step="0.01" class="form-control" placeholder="Price" required><br>   </div>'
                                                        
                                        
                                                  
                                                                table_output += ' </div> '
                                                    table_output += '</form>'
                                                    table_output += '</table>';
                                                    //table_output += '<button id="button">Generate PDF</button>'
                                    
                                                    document.getElementById('excel_data').innerHTML = table_output;
                                                }
                                    
                                                excel_file.value = '';
                                    
                                            }
                                    
                                        });
                                
                                       
                                    
                                    </script>


</html>
 